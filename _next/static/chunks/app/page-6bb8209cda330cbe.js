(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8143:function(e,n,l){Promise.resolve().then(l.t.bind(l,98,23)),Promise.resolve().then(l.bind(l,2032))},2032:function(e,n,l){"use strict";l.r(n),l.d(n,{default:function(){return U}});var t=l(7437),a=l(2265);function s(e){return[{content:"높은순 정렬",value:""},{content:"이름순",value:"name"},...e.map(e=>({content:e.kor,value:e.val}))]}var r=l(8024),o=l(7535),c=l(98),i=l.n(c);function d(e){let{children:n,title:l}=e,[s,c]=(0,a.useState)(!1);return(0,t.jsxs)("section",{className:"".concat(i().common_component," mx-auto"),children:[l&&(0,t.jsxs)("div",{className:"".concat(i().head),children:[(0,t.jsx)("h3",{className:"".concat(i().title),children:null!=l?l:""}),(0,t.jsx)("button",{onClick:()=>{c(!s)},children:(0,t.jsx)(r.G,{icon:s?o.gc2:o.onQ})})]}),!s&&n]})}function u(e){let{children:n,...l}=e;return(0,t.jsx)("button",{...l,children:n})}var m=l(1780),h=l.n(m);function x(e){let{id:n="",className:l="",value:a="",placeholder:s,type:r="text",onChange:o}=e,c=e=>{o&&o(e)};return(0,t.jsx)("div",{className:l,children:(0,t.jsx)("input",{id:n,type:r,value:a,placeholder:s,className:"px-2 py-1 rounded-md border border-gray-300 outline-none text-base leading-normal w-full placeholder-gray-700::placeholder",onChange:e=>c(e.target.value)})})}let p={kor:"내파",val:"nae",placeholder:null},v={kor:"쇄빙",val:"swe",placeholder:null},f={kor:"돌파",val:"dol",placeholder:null},j={ship:[{kor:"선원 수",val:"crew",placeholder:null},{kor:"최소 선원 수",val:"minCrew",placeholder:null},{kor:"내구도",val:"durability",placeholder:null},{kor:"적재량",val:"loadedQuantity",placeholder:null},v,f,{kor:"조력",val:"rowing",placeholder:null},p,{kor:"세로돛",val:"verticalSail",placeholder:null},{kor:"가로돛",val:"horizontalSail",placeholder:null},{kor:"능력치 1",val:"stat1",placeholder:"포격, 백병 위력 등"},{kor:"능력치 2",val:"stat2",placeholder:"포격, 백병 위력 등"},{kor:"능력치 3",val:"stat3",placeholder:"포격, 백병 위력 등"}],armor:[p],ram:[v,f],anchor:[p,v,f]};var _=l(3449);function k(e){let{id:n,label:l,checked:a,onChange:s}=e;return(0,t.jsxs)("div",{className:"inline-flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:n,checked:a,onChange:e=>{s(e.target.checked)},className:"sr-only"}),(0,t.jsxs)("label",{htmlFor:n,className:"inline-flex items-center cursor-pointer rounded-full px-3 py-1",style:{backgroundColor:a?"var(--main500)":""},children:[(0,t.jsx)(r.G,{icon:a?_.a3n:_.pL1,className:"mr-1 ".concat(a?"text-white":"text-gray-600")}),(0,t.jsx)("span",{className:"text-sm ".concat(a?"text-white":"text-gray-600"),children:l})]})]})}function b(e){let{backgroundColor:n,children:l}=e;return(0,t.jsx)("div",{className:"inline-flex rounded-md items-center m-0.5 px-2 py-0.5 text-xs text-white",style:{backgroundColor:"".concat(n)},children:l})}function y(e){let{option:n,index:l,onChange:a}=e,s=e=>{let{index:l,key:t,value:s}=e;n[t]=s,a(n,l)},c=j[n.kind];return(0,t.jsxs)("li",{className:h().item,children:[(0,t.jsxs)("section",{className:h().menu,children:[(0,t.jsx)("div",{className:"flex pr-5",children:(0,t.jsx)(k,{id:"".concat(n.kind,"_isUse_").concat(l),label:"".concat(n.isUse?"사용":"대기"),checked:n.isUse,onChange:e=>s({index:l,key:"isUse",value:e})})}),(0,t.jsx)("div",{className:"inline-flex items-center",children:(0,t.jsx)(u,{onClick:()=>{confirm("[".concat(n.name,"]을 삭제할까요?"))&&(n.isDelete=!0,a(n,l))},children:(0,t.jsx)(r.G,{icon:o.I7k,className:"text-gray-500"})})})]}),(0,t.jsx)("section",{className:h().label,children:n.isMount&&(0,t.jsx)(b,{backgroundColor:"#00bba3",children:"#장착"})}),(0,t.jsxs)("section",{className:h().head,children:[(0,t.jsx)("div",{className:h().icon,children:(()=>{switch(n.kind){case"armor":return(0,t.jsx)(r.G,{icon:o.isG});case"anchor":return(0,t.jsx)(r.G,{icon:o.SJR});case"ram":return(0,t.jsx)(r.G,{icon:o.o9Z});default:return(0,t.jsx)(r.G,{icon:o.bkI})}})()}),(0,t.jsx)("div",{className:h().name,children:(0,t.jsx)(x,{id:"".concat(n.kind,"_name_").concat(l),value:n.name,className:h().input,placeholder:"선박 이름",onChange:e=>s({index:l,key:"name",value:e})})})]}),(0,t.jsx)("section",{className:h().body,children:c.map(e=>{var a,r;return(0,t.jsxs)("div",{className:h().stat_row,children:[(0,t.jsx)("label",{htmlFor:"".concat(n.kind,"_").concat(e.val,"_").concat(l),children:e.kor}),(0,t.jsx)(x,{type:"number",id:"".concat(n.kind,"_").concat(e.val,"_").concat(l),className:h().input,value:String(null!==(a=n[e.val])&&void 0!==a?a:""),placeholder:"".concat(null!==(r=e.placeholder)&&void 0!==r?r:"".concat(e.kor," 입력")),onChange:n=>s({index:l,key:e.val,value:Number(n)})})]},e.val)})})]})}function g(e){let{useItem:n,changeUseItem:l,addUseItem:a,kind:s}=e;return!function(e){let n=0;e.forEach(e=>{e.isMount=!1,e.isUse&&"ship"!==e.kind&&++n<=7&&(e.isMount=!0)})}(n),(0,t.jsx)("div",{className:"".concat(h().wrap),children:(0,t.jsxs)("ul",{className:"".concat(h().list),children:[n.map((e,n)=>(0,t.jsx)(y,{index:n,option:e,onChange:l},n)),(0,t.jsx)("li",{className:"".concat(h().item," ").concat(h().add),children:(0,t.jsxs)(u,{onClick:()=>a(s),children:[(0,t.jsx)(r.G,{icon:o.r8p,className:"mr-2 text-lg"}),(0,t.jsx)("span",{className:"text-lg font-semibold",children:"추가"})]})})]})})}function w(e){var n;let{options:l,onSelect:s,selectedValue:c}=e,[i,d]=(0,a.useState)(null!=c?c:null),[u,m]=(0,a.useState)(!1),h=e=>{d(e),s(e),m(!1)};return(0,t.jsxs)("div",{className:"relative w-full text-left",children:[(0,t.jsxs)("button",{type:"button",className:"flex items-center justify-between w-full px-4 py-2 border border-gray-300 rounded cursor-pointer hover:bg-gray-300 focus:outline-none","aria-haspopup":"true","aria-expanded":u?"true":"false",onClick:()=>m(!u),children:[(0,t.jsx)("span",{className:"text-sm",children:null===(n=l.find(e=>e.value===i))||void 0===n?void 0:n.content}),(0,t.jsx)(r.G,{icon:o.eW2,className:"ml-3 ".concat(u?"transform rotate-180":"")})]}),u&&(0,t.jsx)("div",{className:"origin-top-right absolute right-0 mt-1 w-full rounded-md shadow-lg bg-white z-50",children:(0,t.jsx)("div",{className:"py-1",role:"menu","aria-orientation":"vertical","aria-labelledby":"options-menu",children:l.map((e,n)=>(0,t.jsx)("button",{onClick:()=>h(e.value),className:"whitespace-nowrap block px-4 py-2 text-sm text-gray-700 w-full text-left hover:bg-gray-100 hover:text-gray-900 focus:outline-none",role:"menuitem",children:e.content},n))})})]})}async function N(){return new Promise((e,n)=>{let l=window.indexedDB.open("dhoCalDB",1);l.onerror=()=>{console.error("Failed to open database"),n(l.error)},l.onsuccess=()=>{e(l.result)},l.onupgradeneeded=e=>{e.target.result.createObjectStore("useData",{keyPath:"id",autoIncrement:!0}).createIndex("by_kind","kind",{unique:!1})}})}async function S(e){let n=(await N()).transaction(["useData"],"readwrite").objectStore("useData").put(e);return new Promise((e,l)=>{n.onerror=()=>{console.error("Failed to save data"),l(n.error)},n.onsuccess=()=>{console.log("Data saved successfully"),e()}})}async function C(){let e=(await N()).transaction(["useData"],"readonly").objectStore("useData").getAll();return new Promise((n,l)=>{e.onerror=()=>{console.error("Failed to get data"),l(e.error)},e.onsuccess=()=>{n(e.result)}})}async function I(){try{let e=await C();if(0===e.length)throw Error("저장된 데이터가 없습니다.");let n=e[0];for(let l of e)l.id>n.id&&(n=l);return n}catch(e){return console.error("마지막 데이터 가져오기 실패:",e),{useShips:[],useArmors:[],useRams:[],useAnchor:[]}}}function U(){let[e,n]=(0,a.useState)(!1),[l,r]=(0,a.useState)({ship:0,armor:0,anchor:0,ram:0}),[o,c]=(0,a.useState)([]),[i,u]=(0,a.useState)([]),[m,h]=(0,a.useState)([]),[x,p]=(0,a.useState)([]);(0,a.useEffect)(()=>{I().then(e=>{c(e.useShips||[]),u(e.useArmors||[]),h(e.useRams||[]),p(e.useAnchor||[]),r({ship:e.useShips.length,armor:e.useArmors.length,ram:e.useRams.length,anchor:e.useAnchor.length}),n(!0)}).catch(e=>{console.error("데이터 가져오기 실패:",e),n(!0)})},[]),(0,a.useEffect)(()=>{e&&S({useShips:o,useArmors:i,useRams:m,useAnchor:x})},[o,i,m,x]);let v=e=>{let n,l;let t="";switch(e){case"armor":n=[...i],l=u,t="장갑";break;case"ram":n=[...m],l=h,t="충각";break;case"anchor":n=[...x],l=p,t="닻";break;default:n=[...o],l=c,t="선박"}return{newUseItem:n,setUseItem:l,korLang:t}},f=e=>{var n,t,a,s,o,c,i,d,u,m,h,x,p,f,j,_,k;let{newUseItem:b,setUseItem:y,korLang:g}=v(e),w={name:null!==(t=(n={name:"".concat(l[e]+1,"번 ").concat(g),kind:e}).name)&&void 0!==t?t:"",kind:null!==(a=n.kind)&&void 0!==a?a:"ship",crew:null!==(s=n.crew)&&void 0!==s?s:null,minCrew:null!==(o=n.minCrew)&&void 0!==o?o:null,durability:null!==(c=n.durability)&&void 0!==c?c:null,loadedQuantity:null!==(i=n.loadedQuantity)&&void 0!==i?i:null,swe:null!==(d=n.swe)&&void 0!==d?d:null,dol:null!==(u=n.dol)&&void 0!==u?u:null,rowing:null!==(m=n.rowing)&&void 0!==m?m:null,nae:null!==(h=n.nae)&&void 0!==h?h:null,verticalSail:null!==(x=n.verticalSail)&&void 0!==x?x:null,horizontalSail:null!==(p=n.horizontalSail)&&void 0!==p?p:null,stat1:null!==(f=n.stat1)&&void 0!==f?f:null,stat2:null!==(j=n.stat2)&&void 0!==j?j:null,stat3:null!==(_=n.stat3)&&void 0!==_?_:null,isUse:null===(k=n.isUse)||void 0===k||k};r(n=>({...n,[e]:(n[e]||0)+1})),b.push(w),y(b)},_=(e,n)=>{let{newUseItem:l,setUseItem:t}=v(e.kind);e.isDelete?l.splice(n,1):l[n]=e,t(l)},k=(e,n)=>{if(""===e)return;let{newUseItem:l,setUseItem:t}=v(n);t("name"===e?l.sort((n,l)=>n[e].localeCompare(l[e])):l.sort((n,l)=>(l[e]||0)-(n[e]||0)))};return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{title:"선박 입력",children:(0,t.jsx)(g,{useItem:o,addUseItem:f,changeUseItem:_,kind:"ship"})}),(0,t.jsxs)(d,{title:"장갑 입력",children:[(0,t.jsx)("div",{className:"flex justify-end py-1 px-2",children:(0,t.jsx)("div",{className:"w-40",children:(0,t.jsx)(w,{options:s(j.armor),selectedValue:"",onSelect:e=>k(e,"armor")})})}),(0,t.jsx)(g,{useItem:i,addUseItem:f,changeUseItem:_,kind:"armor"})]}),(0,t.jsxs)(d,{title:"충각 입력",children:[(0,t.jsx)("div",{className:"flex justify-end py-1 px-2",children:(0,t.jsx)("div",{className:"w-40",children:(0,t.jsx)(w,{options:s(j.ram),selectedValue:"",onSelect:e=>k(e,"ram")})})}),(0,t.jsx)(g,{useItem:m,addUseItem:f,changeUseItem:_,kind:"ram"})]}),(0,t.jsxs)(d,{title:"닻 입력",children:[(0,t.jsx)("div",{className:"flex justify-end py-1 px-2",children:(0,t.jsx)("div",{className:"w-40",children:(0,t.jsx)(w,{options:s(j.anchor),selectedValue:"",onSelect:e=>k(e,"anchor")})})}),(0,t.jsx)(g,{useItem:x,addUseItem:f,changeUseItem:_,kind:"anchor"})]})]}):null}},98:function(e){e.exports={content_header:"components_content_header__RISor",inner:"components_inner__9JA8l",common_component:"components_common_component__i8cRW",head:"components_head__GDvkt",title:"components_title__YE30R"}},1780:function(e){e.exports={wrap:"fleet_wrap__Vz8r_",list:"fleet_list__ufHl_",item:"fleet_item__TAaxz",add:"fleet_add__jTvzr",menu:"fleet_menu__azIr9",label:"fleet_label__tFwb2",head:"fleet_head__hAHJS",name:"fleet_name__YqVEZ",icon:"fleet_icon__fAqwD",body:"fleet_body__bE8PO",stat_row:"fleet_stat_row__clXz_"}}},function(e){e.O(0,[676,906,971,69,744],function(){return e(e.s=8143)}),_N_E=e.O()}]);